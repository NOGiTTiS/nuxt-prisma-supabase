import{_}from"./DIW4Faj0.js";import{e as L,E as P,r as d,c as w,a as s,G as h,u as r,H as E,t as N,I as A,J as p,K as f,L as v,b as S,w as V,o as x,d as C}from"./DP3e9UH5.js";import{u as T}from"./ifNg6dYy.js";import{u as I}from"./L4vgTm4O.js";import{u as B}from"./DzwoSD2O.js";import"./IShi1APO.js";const D={class:"bg-base-200 h-[calc(100vh-50px)] flex items-center justify-center"},R={class:"card lg:card-side bg-base-100 shadow-xl max-w-4xl w-full"},G={class:"card-body lg:w-1/2"},O={class:"form-control"},U={class:"input input-bordered flex items-center gap-2"},W={class:"form-control mt-4"},j={class:"input input-bordered flex items-center gap-2"},H={class:"form-control"},M={class:"input input-bordered flex items-center gap-2"},z={class:"text-center mt-4"},Z=L({__name:"login",setup(J){const b=P(),i=d(""),u=d(""),n=d("+66"),t=d(""),o=d(!1),g=B(),y=async()=>{var a;if(!i.value||!u.value){t.value="Please enter both email and password.",o.value=!1;return}try{const{data:e,error:c}=await g.auth.signInWithPassword({email:i.value,password:u.value});if(c)throw c;const l=(a=e.session)==null?void 0:a.access_token;if(console.log("token:",l),l){const m=T("auth_tokens");m.value=l,m.options={expires:7}}t.value="Login successful!",o.value=!0,await new Promise(m=>setTimeout(m,2e3)),b.push("/backend/dashboard")}catch(e){e instanceof Error?(t.value=e.message,o.value=!1):(t.value="An unknown error occurred",o.value=!1)}},k=async()=>{if(!n.value){t.value="Please enter your phone number.",o.value=!1;return}try{const{error:a}=await g.auth.signInWithOtp({phone:n.value});if(a)throw a;localStorage.setItem("phone",n.value),t.value="OTP sent! Please check your phone for the verification code.",o.value=!0,b.push("/verify")}catch(a){a instanceof Error?(t.value=a.message,o.value=!1):(t.value="An unknown error occurred",o.value=!1)}};return I({title:"Login",meta:[{name:"keywords",content:"Login, Nuxt 3, Backend"},{name:"Description",content:"Login Nuxt 3,  IT Genius Engineering"}]}),(a,e)=>{const c=_;return x(),w("div",D,[s("div",R,[e[12]||(e[12]=s("figure",{class:"lg:w-1/2"},[s("img",{src:"https://media.tenor.com/p0G_bmA2vSYAAAAd/login.gif",alt:"Random image",class:"object-cover w-full h-full"})],-1)),s("div",G,[e[10]||(e[10]=s("h2",{class:"card-title text-2xl font-bold mb-6"},"Login",-1)),s("form",{onSubmit:h(y,["prevent"])},[r(t)?(x(),w("p",{key:0,class:E([r(o)?"bg-success":"bg-error","p-3 rounded-lg text-white"])},N(r(t)),3)):A("",!0),s("div",O,[e[3]||(e[3]=s("label",{class:"label"},[s("span",{class:"label-text"},"Email")],-1)),s("label",U,[p(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>v(i)?i.value=l:null),type:"email",class:"grow",placeholder:"email@example.com"},null,512),[[f,r(i)]])])]),s("div",W,[e[4]||(e[4]=s("label",{class:"label"},[s("span",{class:"label-text"},"Password")],-1)),s("label",j,[p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>v(u)?u.value=l:null),type:"password",class:"grow",placeholder:"Enter password"},null,512),[[f,r(u)]])])]),e[5]||(e[5]=s("div",{class:"form-control mt-6"},[s("button",{type:"submit",class:"btn btn-primary w-full"},"Login with Email")],-1))],32),e[11]||(e[11]=s("div",{class:"divider"},"OR",-1)),s("form",{onSubmit:h(k,["prevent"])},[s("div",H,[e[6]||(e[6]=s("label",{class:"label"},[s("span",{class:"label-text"},"Phone Number")],-1)),s("label",M,[p(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>v(n)?n.value=l:null),type:"tel",class:"grow",placeholder:"+1234567890"},null,512),[[f,r(n)]])])]),e[7]||(e[7]=s("div",{class:"form-control mt-6"},[s("button",{type:"submit",class:"btn btn-primary w-full"},"Login with Phone")],-1))],32),s("div",z,[e[9]||(e[9]=s("p",null,"Don't have an account?",-1)),S(c,{to:"/register",class:"link link-primary"},{default:V(()=>e[8]||(e[8]=[C("Sign up now")])),_:1})])])])])}}});export{Z as default};
